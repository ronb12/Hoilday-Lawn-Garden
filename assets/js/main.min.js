import{initializeApp,getApps}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";import{getFirestore,doc,getDoc}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";import{getAuth,signInWithEmailAndPassword,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";const firebaseConfig={apiKey:"AIzaSyBXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",authDomain:"holliday-lawn-garden.firebaseapp.com",projectId:"holliday-lawn-garden",storageBucket:"holliday-lawn-garden.appspot.com",messagingSenderId:"123456789012",appId:"1:123456789012:web:abcdef1234567890"};let app;if(!getApps().length){app=initializeApp(firebaseConfig)}else{app=getApps()[0]}const db=getFirestore(app);const auth=getAuth(app);console.log("main.js loaded");const publicPages=["index.html","about.html","services.html","education.html","faq.html","contact.html","privacy.html","terms.html","gallery.html","offline.html","admin-login.html"];onAuthStateChanged(auth,async user=>{if(user){try{const userDoc=await getDoc(doc(db,"users",user.uid));if(userDoc.exists()){const userData=userDoc.data();console.log("User role:",userData.role);const currentPage=window.location.pathname.split("/").pop();if(!publicPages.includes(currentPage)){if(userData.role==="admin"&&currentPage!=="admin-dashboard.html"){window.location.href="admin-dashboard.html"}else if(userData.role==="user"&&currentPage!=="customer-dashboard.html"){window.location.href="customer-dashboard.html"}}}}catch(error){console.error("Error checking user role:",error)}}});document.getElementById("loginForm")?.addEventListener("submit",async e=>{e.preventDefault();const email=document.getElementById("email").value;const password=document.getElementById("password").value;try{const userCredential=await signInWithEmailAndPassword(auth,email,password);const user=userCredential.user;const userDoc=await getDoc(doc(db,"users",user.uid));if(userDoc.exists()){const userData=userDoc.data();console.log("User role:",userData.role);if(userData.role==="admin"){window.location.href="admin-dashboard.html"}else{window.location.href="customer-dashboard.html"}}else{showError("User data not found. Please contact support.")}}catch(error){console.error("Login error:",error);showError("Invalid email or password.")}});document.getElementById("logoutBtn")?.addEventListener("click",async()=>{try{await auth.signOut();window.location.href="login.html"}catch(error){console.error("Logout error:",error);showError("Error signing out. Please try again.")}});function showError(message){const errorDiv=document.getElementById("error-message");if(errorDiv){errorDiv.textContent=message;errorDiv.style.display="block"}else{alert(message)}}document.addEventListener("DOMContentLoaded",function(){const hamburger=document.querySelector(".hamburger");const nav=document.querySelector("nav");const navLinks=document.querySelector(".nav-links");const body=document.body;if(hamburger){hamburger.addEventListener("click",function(){hamburger.classList.toggle("active");nav.classList.toggle("active");navLinks.classList.toggle("active");body.classList.toggle("menu-open");const isExpanded=hamburger.getAttribute("aria-expanded")==="true";hamburger.setAttribute("aria-expanded",!isExpanded)});document.addEventListener("click",function(event){const isClickInside=nav.contains(event.target)||hamburger.contains(event.target);if(!isClickInside&&nav.classList.contains("active")){hamburger.classList.remove("active");nav.classList.remove("active");navLinks.classList.remove("active");body.classList.remove("menu-open");hamburger.setAttribute("aria-expanded","false")}});document.addEventListener("keydown",function(event){if(event.key==="Escape"&&nav.classList.contains("active")){hamburger.classList.remove("active");nav.classList.remove("active");navLinks.classList.remove("active");body.classList.remove("menu-open");hamburger.setAttribute("aria-expanded","false")}});window.addEventListener("resize",function(){if(window.innerWidth>768&&nav.classList.contains("active")){hamburger.classList.remove("active");nav.classList.remove("active");navLinks.classList.remove("active");body.classList.remove("menu-open");hamburger.setAttribute("aria-expanded","false")}})}}); 